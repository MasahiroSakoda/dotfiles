#!/usr/bin/env bash
# -*-mode:sh-*- vim:ft=sh

set -eo pipefail

{{ template "common/script_eval_brew" . }}

PLUGINS="python poetry ruby nodejs deno"

# TODO: install from ~/.tool-versions

. "$(brew --prefix asdf)/libexec/asdf.sh"

for PLUGIN in ${PLUGINS}; do
  # Install asdf plugin
  if asdf plugin-list | grep -Fq ${PLUGIN}; then
    echo "asdf plugin \"${PLUGIN}\" is already installed"
    asdf plugin-update ${PLUGIN}
  else
    echo "installing ${PLUGIN}..."
    asdf plugin-add ${PLUGIN}

    # Install latest version
    asdf install ${PLUGIN} latest
    asdf global ${PLUGIN} latest

    echo "${PLUGIN} installed to $(which ${PLUGIN})"
  fi
done

asdf reshim
asdf current
