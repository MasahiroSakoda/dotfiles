#!/usr/bin/env bash
# -*-mode:sh-*- vim:ft=sh

set -eo pipefail

{{ template "common/script_eval_brew" . }}
{{ template "common/script_sudo" . }}

# Install Homebrew
BREW_DIR="$HOME/.config/homebrew"
if ! command -v brew > /dev/null 2>&1 && [ -f "$BREW_DIR/Brewfile" ]; then
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi

# Install Homebrew packages
brew bundle -v --file="$BREW_DIR/Brewfile"

{{ if not .headless }}
brew bundle -v --file="$BREW_DIR/Caskfile"
brew bundle -v --file="$BREW_DIR/Masfile"
{{ end }}

brew list
