#!/usr/bin/env bash
# -*-mode:sh-*- vim:ft=sh

set -e

{{ template "script_darwin_only" . }}
{{ template "script_sudo" . }}

# Change default shell
FISH_PATH=$(which fish)

if ! grep -q "${FISH_PATH}" /etc/shells ; then
  echo "${FISH_PATH}" | sudo tee -a /etc/shells
fi

if [[ "$SHELL" != "${FISH_PATH}" ]] ; then
  sudo chsh -s "${FISH_PATH}"
fi

# Install/Update fish shell plugin
if ! [ -e "$HOME/.config/fish/functions/fisher.fish" ]; then
  curl https://git.io/fisher --create-dirs -sLo ~/.config/fish/functions/fisher.fish
fi

fish -c fisher update
